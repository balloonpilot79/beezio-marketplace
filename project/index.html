<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/bumblebee.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Mobile Optimizations -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Beezio" />
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#d97706" />
    <meta name="msapplication-TileColor" content="#d97706" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/bumblebee.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/bumblebee.svg" />
    
    <!-- Description for Mobile -->
    <meta name="description" content="The revolutionary affiliate marketing ecommerce platform where sellers, affiliates, and causes thrive together" />
    <meta name="keywords" content="affiliate marketing, ecommerce, sellers, fundraising, mobile commerce" />
    
    <title>Beezio - Affiliate Marketing Ecommerce Platform</title>
  </head>
  <body>
    <div id="root"></div>
    <!--
      Inline script: aggressively unregister any active service workers and reload once.
      This runs before the app bundle so it helps clear stale cached bundles that can
      cause runtime errors (for example, old versions of contexts that throw when
      used before providers were added). It sets a localStorage flag so it only triggers
      a single reload to avoid reload loops.
    -->
    <script>
      (function() {
        try {
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
              if (registrations && registrations.length > 0 && !localStorage.getItem('beezio_sw_unregistered')) {
                console.log('Found active service workers â€” unregistering to clear stale caches.');
                registrations.forEach(function(r) {
                  try { r.unregister(); } catch (e) { console.warn('SW unregister error', e); }
                });
                // Mark that we've unregistered once so we don't loop.
                localStorage.setItem('beezio_sw_unregistered', '1');
                // Reload so the browser fetches the latest assets from the network.
                window.location.reload();
              }
            }).catch(function(err){
              console.warn('Error while checking service workers:', err);
            });
          }
        } catch (e) {
          console.warn('SW unregister helper failed:', e);
        }
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
